{% extends 'base.html' %} {% block content %}
<style>
  .header {
    font-family: Poppins;
    font-size: 18px;
    font-weight: 600;
    line-height: 14px;
    letter-spacing: 0em;
    text-align: left;
    color: #314c74;
    margin-top: 7px;
    margin-left: 10px;
  }
  .info-heading {
    height: 32.094635009765625px;
    width: 533.0104370117188px;
    left: 299.7646484375px;
    top: 217.8798828125px;
    font-family: Poppins;
    font-size: 16px;
    font-weight: 600;
    line-height: 14px;
    letter-spacing: 0em;
    text-align: left;
    color: #617594;
    text-align: left;
    justify-content: left;
    flex:20%
  }
  .top-ctn {
    justify-content: left;
    margin-top: -400px;
    margin-left: -250px;
  }
  .chevron {
    margin-left: 20px;
  }
  .company-report-name {
    font-family: Poppins;
    font-size: 18px;
    font-weight: 400;
    line-height: 20px;
    letter-spacing: 0em;
    text-align: left;
    height: 46px;
    width: 427.2080078125px;
    left: 642.7412109375px;
    top: 169.65625px;
    color: #314c74;
    margin-top: 3px;
    margin-left: 20px;
  }
  .info-block {
    height: 171.09292602539062px;
    width: 1077.1351318359375px;
    left: 299.943359375px;
    top: 263.57275390625px;
    border-radius: 15px;
    background-color: #dfe3ea;
  }
  .report-prop {
    height: 22.0791015625px;
    width: 197.63427734375px;
    left: 334.97412109375px;
    top: 297.52197265625px;
    font-family: Poppins;
    font-size: 12px;
    font-weight: 700;
    line-height: 15px;
    letter-spacing: 0em;
    text-align: left;
    color: #717171;
  }
  .input-report-prop {
    height: 28.689281463623047px;
    width: 497.80096435546875px;
    left: 334.97412109375px;
    top: 382.7646484375px;
    font-family: Poppins;
    font-size: 12px;
    font-weight: 500;
    line-height: 15px;
    letter-spacing: 0em;
    text-align: left;
    color: #717171;
  }
  .download-csv {
    height: 30.381864547729492px;
    width: 130.93368530273438px;
    left: 1215.1025390625px;
    top: 289.8447265625px;
    border-radius: 6px;
    background-color: #6f83a5;
    border: 0px;
    color: white;
  }
  .report-editor-tools {
    height: 83.36266326904297px;
    width: 1077px;
    left: 299.76953125px;
    top: 494.64306640625px;
    background-color: #dfe3ea;
    border-radius: 12px 12px 0px 0px;
    margin-left: -250px;
  }
  .gen-draft {
    height: 29.232547760009766px;
    width: 130.93368530273438px;
    left: 1215.1025390625px;
    top: 522.40625px;
    border-radius: 6px;
    border: 0px;
    font-family: Poppins;
    font-size: 12px;
    font-weight: 600;
    line-height: 14px;
    letter-spacing: 0em;
    text-align: center;
    color: white;
  }
  .report-view {
    height: 643.8424682617188px;
    width: 1077px;
    left: 299.771484375px;
    top: 578.02978515625px;
    background: #e9ebef;
    border-radius: 0px 0px 12px 12px;
    margin-left: -250px;
  }
  .audit-log-link {
    text-align: left;
    margin-left: 35px;
    margin-top: 30px;
  }
  #auditLogLabel {
    height: 32.094635009765625px;
    width: 394.2548828125px;
    margin-top: 23.52px;
    margin-left: 35.84;
    border-radius: nullpx;
    font-family: Poppins;
    font-size: 14px;
    font-weight: 700;
    line-height: 14px;
    letter-spacing: 0em;
    text-align: left;
    color: #314c74;
  }
  #audit-modal-header {
    display: flex;
    flex-direction: column;
    margin-top: -10px;
    
  }
  #audit-modal-body {
    margin-top: -20px;
    height: 220px;
  }
  .log-rec {
    display: flex;
    flex-direction: row;
    flex: 100%;
    margin-left:15px;
    
  }
  .log-col-header{
    width: 33%;
    font-family: Poppins;
    font-size: 12px;
    font-weight: 600;
    line-height: 14px;
    letter-spacing: 0em;
    text-align: left;
    color:#717171;
  }
  .log-col {
    font-family: Poppins;
    font-size: 12px;
    font-weight: 500;
    opacity: 70%;
    line-height: 15px;
    letter-spacing: 0em;
    text-align: left;
    color:#7D7E8C;
    width: 33%;
    left: 35.84765625px;
    top: 148.4990234375px;
  }
  .modal-btm {
      margin-left: 315px;
      margin-bottom: 25.24px;
  }
  .close-btn {
    height: 30.382007598876953px;
    width: 155.93359375px;
    left: 489.51171875px;
    top: 430.89404296875px;
    border-radius: 12px;
    color: #314C74;
    background-color: #ffffff;
    border: 2px solid #8FA3C1;
    font-family: Poppins;
    font-size: 14px;
    font-weight: 600;
    line-height: 11px;
    letter-spacing: 0em;
    text-align: center;
    padding: 10px;
  }
  .pdf-toggle{
    margin-top: -35px;
    display: flex;
    flex-direction: row;
    margin-left: 250px;
  }
  .page-box {
    height: 33px;
    width: 34.73114013671875px;
    border-radius: 6px;
    border: 1px solid #61616133;
    background-color: white;
    margin-top: -7px;
    margin-left: 6px;
    padding: 8px;
    font-family: Poppins;
    font-size: 12px;
    font-weight: 600;
    line-height: 14px;
    letter-spacing: 0em;
    text-align: center;
    color:#717171;
  }
  .page-wordings {
    height: 31px;
    width: 34.73114013671875px;
    left: 691.7294921875px;
    top: 521.46875px;
    border-radius: nullpx;
    font-family: Poppins;
    font-size: 12px;
    font-weight: 600;
    line-height: 14px;
    letter-spacing: 0em;
    text-align: center;
    color:#717171;
    margin-top: 2px;
  }

  .pdfViewerObj {
    height: 577.308837890625px;
    width: 1015.1979370117188px;
    left: 329.859375px;
    top: 638.140625px;
    border-radius: 0px;
    margin-top: 30px;
    overflow-x: scroll;
    overflow-y: hidden;
  }

  .page-button {
    margin-bottom: 120px;
    padding-top: 0;
    border: 0px;
    background-color: #dfe3ea;
  }

  #warningModal{
    margin-top: 200px;
    display: block;
    width: 900px;
    height: 500px;
    margin-left: 200px;
  }

  #changedTemplate{
    margin-top: 200px;
    display: block;
    width: 900px;
    height: 500px;
    margin-left: 200px;
    display: none;
  }

  #infoModal{
    margin-top: 200px;
    display: block;
    width: 900px;
    height: 500px;
    margin-left: 200px;
    display: none;
  }

  #warning-modal-title {
    color: #ffffff;
    font-family: Poppins;
    font-size: 18px;
    font-weight: 600;
    line-height: 10px;
    letter-spacing: 0em;
    text-align: left;
    height: 117.37568664550781px;
    width: 377.98834228515625px;
    margin-top: 110px;
  }
  .warning-btn {
    height: 30.382007598876953px;
    width: 233.900390625px;
    left: 153.533447265625px;
    top: 328.25390625px;
    border-radius: 12px;
    border: 2px solid #de7777;
    font-family: Poppins;
    font-size: 14px;
    font-weight: 600;
    line-height: 11px;
    letter-spacing: 0em;
    text-align: center;
    color: #B24141;
    text-align: center;
    background-color: #FFFFFF;
    padding:8px;
  }

  .btm-btn {
    display: flex;
    flex-direction: row;
    margin-left:160px
  }

  #err-blk {
    display: none;
    flex-direction: column;
    justify-content: right;
    margin-left: 800px;
    margin-top: 10px;
    position: absolute;
  }
  .err-msg {
    height: 52px;
    width: 259.344970703125px;
    border-radius: 15px;
    border: 3px solid #e2c6c6;
    background-color: #efe2e2;
    color: #d63636;
    font-family: Poppins;
    font-size: 8px;
    font-weight: 600;
    line-height: 11px;
    letter-spacing: 0em;
    padding: 10px;
  }

  .edit-info {
    font-family: Poppins;
    font-size: 11px;
    font-weight: 600;
    line-height: 15px;
    letter-spacing: 0em;
    text-align: left;
    font-family: Poppins;
    font-size: 11px;
    font-weight: 700;
    line-height: 15px;
    letter-spacing: 0em;
    text-align: left;
    color: #718FBF;
    flex: 60%;
    text-decoration: underline;
  }

  .dropdown-options {
    text-align: left ;
    color: #60769c;
    font-family: Poppins;
    font-size: 12px;
    font-weight: 600;
    line-height: 14px;
    letter-spacing: 0em;
  }

</style>

<script>

  var pageCount = 1
  $(document).ready(function() {
    console.log('pdf gen status')
    console.log('{{pdf_gen_error}}')
    console.log('{{pdf_gen_error}}' == 'True')
    if ('{{pdf_gen_error}}' == 'True') {
      $("warningModal").modal('show')
    } else {
    prepPdfViewer();
    popFields();
    }
  })

  function prepPdfViewer() {
    var newUrl = '{{pdf_path}}#page=' + pageCount.toString()
    var objectEl = document.getElementById('pdfViewerObj');
    objectEl.setAttribute('data', newUrl)
    objectEl.outerHTML = objectEl.outerHTML.replace(/data="(.+?)"/, 'data="' + newUrl + '"');
  }

  function popFields() {
    document.getElementById('corp-name').innerHTML = '{{corp_name}}'.replace('&amp;', '&')
    document.getElementById('corp-report-title').innerHTML = '{{corp_report_title}}'
    document.getElementById('corp-report-type').innerHTML = '{{corp_report_type}}'
    document.getElementById('corp-report-batches').innerHTML = '{{corp_report_batches}}'
    document.getElementById('page-count-display').innerHTML = '{{num_pages}}'
  }

  function increasePgCount() {
      if (pageCount >= parseInt('{{num_pages}}')) {
        return
      }
      pageCount += 1
      document.getElementById('currPageNumber').innerHTML = pageCount
      prepPdfViewer()
  }

  function decreasePgCount() {
      if (pageCount > 1) {
        pageCount -= 1
      document.getElementById('currPageNumber').innerHTML = pageCount
      prepPdfViewer()
      }
  }

  function closeWarningModal() {
    document.getElementById('warningModal').style.display = 'none';
  }

  function closeTemplateModal() {
    document.getElementById('changedTemplate').style.display = 'none';
  }

  function downloadCSVAbort() {
    console.log('download csv and abort called')
    window.location.href="invalidGeneration"
  }

  function downloadCSV() {
    let req = axios({
                  method: 'get',
                  url: 'downloadcsv',
                  xstfCookieName: 'csrftoken',
                  xsrfHeaderName: 'X-CSRFToken',
                  headers: {
                    'X-CSRFToken': 'csrftoken'
                  }
                  }).then((response) => {
                    if (response.status_code ==404) {
                      return
                    } else {
                      window.location.href='downloadcsv'
                    }
                  });
  }

  function downloadCSVProceed() {
    console.log('download csv and proceed called')
    document.getElementById('warningModal').style.display = 'none';
    document.getElementById('err-blk').style.display = 'block';
    prepPdfViewer();
    popFields();
  }

  var initial_template_idx = 1
  var selected_template = 1
  function selectTemplateType() {
    var selectBox = document.getElementById("templateTypeSelection");
    var selectedValue = selectBox.options[selectBox.selectedIndex].value;
    selected_template = selectedValue
    console.log('template type is')
    console.log(selected_template)
  };

  function regenPDF() {
    console.log(initial_template_idx)
    console.log(selected_template)
    if (selected_template != initial_template_idx) {
      document.getElementById('changedTemplate').style.display = 'block';
    } else {
      window.location.href="../healthReportInfo"
    }
  }

  function proceedChanges() {
    window.location.href="../healthReportInfo"
  }

  function openInfoModal() {
    document.getElementById('infoModal').style.display = 'block';
  }

  function closeInfoModal() {
    document.getElementById('infoModal').style.display = 'none';
  }
</script>

<div style="display: flex; flex-direction: column;">
  <div class="top-ctn">
    <div>
      <div class="breadcrumb" style="padding-top: 10rem;">
        <span class="dashboard-icon material-symbols-outlined text-blue-01">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            fill="currentColor"
            class="bi bi-folder-plus"
            viewBox="0 0 16 16"
            color="#314C74"
          >
            <path
              d="m.5 3 .04.87a1.99 1.99 0 0 0-.342 1.311l.637 7A2 2 0 0 0 2.826 14H9v-1H2.826a1 1 0 0 1-.995-.91l-.637-7A1 1 0 0 1 2.19 4h11.62a1 1 0 0 1 .996 1.09L14.54 8h1.005l.256-2.819A2 2 0 0 0 13.81 3H9.828a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 6.172 1H2.5a2 2 0 0 0-2 2zm5.672-1a1 1 0 0 1 .707.293L7.586 3H2.19c-.24 0-.47.042-.683.12L1.5 2.98a1 1 0 0 1 1-.98h3.672z"
            />
            <path
              d="M13.5 10a.5.5 0 0 1 .5.5V12h1.5a.5.5 0 1 1 0 1H14v1.5a.5.5 0 1 1-1 0V13h-1.5a.5.5 0 0 1 0-1H13v-1.5a.5.5 0 0 1 .5-.5z"
            />
          </svg>
        </span>
        <li class="header">
          Corporate Health Screening Report
          <a href="/"></a>
        </li>
        <p class="chevron">
          <span class="material-symbols-outlined">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              fill="currentColor"
              class="bi bi-chevron-right"
              viewBox="0 0 16 16"
              color="#314C74"
            >
              <path
                fill-rule="evenodd"
                d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"
              />
            </svg>
          </span>
        </p>
        <div class="company-report-name">
          SIA Corporate Health Report II (2021)
        </div>
      </div>
    </div>
    <div style="display: flex; flex-direction:row">
      <p class="info-heading">
        Corporate Health Report Info
      </p>
      <href class="edit-info" onclick="openInfoModal()">Edit</href>
    </div>
    <div
    class="modal"
    id="infoModal"
    tabindex="-1"
    aria-labelledby="infoModalLabel"
    aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header"
          style="
          height: 117.37568664550781px;
          width: 681.9871826171875px;
          background-color: #de7777;">
            <svg xmlns="http://www.w3.org/2000/svg" width="46.41" height="40" fill="white" class="bi bi-exclamation-triangle-fill" viewBox="0 0 16 16"
            style="margin: 38.01px 74.66px 35.37px 69.41px;">
              <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
            </svg>
            <h5 class="modal-title" id="warning-modal-title">Warning: This cannot be undone.</h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
              onclick="closeInfoModal()"
              aria-label="Close"
              style="margin-right: 10px; margin-top:-35px; height:13.12px; color: white; opacity: 1;"
            ></button>
          </div>
          <div class="modal-body" style="height: 284.62px; width: 682px;border-radius: 0 0 15px 15px; background-color: #ffffff;">
            <div class="modal-text" style="
            color: #de7777;
            height: 143.82505798339844px;
            width: 470.2766723632812px;
            left: 65.78125px;
            top: 202.16015625px;
            text-align: left;
            margin-top: 50px;
            margin-left: 100px;
            font-family: Poppins;
            font-size: 16px;
            font-weight: 500;
            line-height: 22px;
            letter-spacing: 0em;
            text-align: left;">
              Changing the Corporate Health Report Info create new changes to this document. Are you sure you want to proceed?
            </div>
            <div class="btm-btn">
              <button type='button' class="warning-btn" onclick="closeInfoModal()">
                Cancel
              </button>
              <div style="width: 11.78px;"></div>
              <button type='button' class="warning-btn" onclick="openCustomReportModal()">
                Proceed
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div
      class="info-block"
      style="display: flex; flex: 100%; flex-direction: row;"
    >
      <div
        style="
          width: 45%;
          display: flex;
          flex-direction: column;
          margin-top: 33.95px;
          margin-left: 33.05px;
        "
      >
        <div style="height: 50%; display: flex; flex-direction: column;">
          <p class="report-prop">Corporate Name (ID)</p>
          <p class="input-report-prop" id="corp-name"></p>
        </div>
        <div style="height: 50%; display: flex; flex-direction: column;">
          <p class="report-prop">Corporate Health Report Title</p>
          <p class="input-report-prop" id="corp-report-title"></p>
        </div>
      </div>
      <div
        style="
          width: 45%;
          display: flex;
          flex-direction: column;
          margin-top: 33.95px;
          margin-left: 33.05px;
        "
      >
        <div style="height: 50%; display: flex; flex-direction: column;">
          <p class="report-prop">Report Type</p>
          <p class="input-report-prop" id="corp-report-type"></p>
        </div>
        <div style="height: 50%; display: flex; flex-direction: column;">
          <p class="report-prop">Batches included in Corporate Report</p>
          <p class="input-report-prop" style="text-decoration: underline; color: #718FBF;" id="corp-report-batches">
          </p>
        </div>
      </div>
      <div style="width: 10%; margin-top: 25px; margin-left: -120px;">
        <button class="download-csv" onclick="downloadCSV()">
          <p
            style="
              font-family: Poppins;
              font-size: 12px;
              font-weight: 600;
              line-height: 14px;
              letter-spacing: 0em;
              text-align: center;
              justify-content: center;
              margin-top: 6px;
            "
          >
            Download CSV
          </p>
        </button>
      </div>
    </div>
  </div>
  <div style="height: 59.98px;"></div>
  <div class="report-editor-tools">
    <div
      style="
        display: flex;
        flex-direction: row;
        justify-content: center;
        margin-top: 5px;
      "
    >
      <div style="width: 55%; padding: 30px;">
        <p
          style="
            font-family: Poppins;
            font-size: 20px;
            font-weight: 600;
            line-height: 14px;
            letter-spacing: 0em;
            text-align: left;
            color: #314c74;
          "
        >
          Report PDF
        </p>
        <div class="pdf-toggle">
          <button class="page-button" onclick="decreasePgCount()">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#A1A1A1" class="bi bi-caret-left-fill" viewBox="0 0 16 16">
              <path d="m3.86 8.753 5.482 4.796c.646.566 1.658.106 1.658-.753V3.204a1 1 0 0 0-1.659-.753l-5.48 4.796a1 1 0 0 0 0 1.506z"/>
            </svg>
          </button>
          <div id='currPageNumber' class="page-box">
            1
          </div>
          <p class="page-wordings">of</p>
          <p id="page-count-display" class="page-wordings"></p>
          <button class="page-button" onclick="increasePgCount()" >
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#A1A1A1" class="bi bi-caret-right-fill" viewBox="0 0 16 16">
              <path d="m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"/>
            </svg>
          </button>
        </div>
      </div>
      <div
        style="
          width: 45%;
          display: flex;
          flex-direction: row;
          margin-top: 20px;
        "
      >
        <div>
          <select
            class="btn btn-secondary dropdown-toggle"
            aria-label="Default select example"
            id = 'templateTypeSelection'
            onchange="selectTemplateType()"
            style="
              height: 30.381864547729492px;
              width: 130.94744873046875px;
              left: 942.1669921875px;
              top: 521.82421875px;
              border-radius: 6px;
              border: 2px solid #6f83a5;
              background: linear-gradient(0deg, #e8ebef, #e8ebef);
              color: #60769c;
              font-family: Poppins;
              font-size: 12px;
              font-weight: 600;
              line-height: 14px;
              letter-spacing: 0em;
              text-align: left;
            "
          >
          <option class="dropdown-options"; value="Template I">Template I</option>
          <option class="dropdown-options"; value="Template II">Template II</option>
          <option class="dropdown-options"; value="Template III">Template III</option>
          <option class="dropdown-options"; value="Template IV">Template IV</option>
        </select>
        </div>
        <div style="margin-left: 5.51px;">
          <button
            class="gen-draft"
            style="background-color: #6f83a5; opacity: 0.5;"
          >
            Email Report
          </button>
        </div>
        <div style="margin-left: 5.51px;">
          <button class="gen-draft" style="background-color: #6f83a5;" onclick="regenPDF()">
            Regenerate PDF
          </button>
          <div
            class="modal"
            id="changedTemplate"
            tabindex="-1"
            aria-labelledby="changedTemplateLabel"
            aria-hidden="true"
          >
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header" style="
                height: 117.37568664550781px;
                width: 681.9871826171875px;
                background-color: #de7777;">
                  <svg xmlns="http://www.w3.org/2000/svg" width="46.41" height="40" fill="white" class="bi bi-exclamation-triangle-fill" viewBox="0 0 16 16"
                  style="margin: 38.01px 74.66px 35.37px 69.41px;">
                    <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
                  </svg>
                  <h5 class="modal-title" id="warning-modal-title">Warning: This cannot be undone.</h5>
                  <button
                    type="button"
                    class="btn-close btn-close-white"
                    data-bs-dismiss="modal"
                    onclick="closeTemplateModal()"
                    aria-label="Close"
                    style="margin-right: 10px; margin-top:-35px; height:13.12px; color: white; opacity: 1;"
                  ></button>
                </div>
                <div class="modal-body" style="height: 284.62px; width: 682px;border-radius: 0 0 15px 15px; background-color: #ffffff;">
                  <div class="modal-text"
                  style="color: #de7777;
                  height: 143.82505798339844px;
                  width: 470.2766723632812px;
                  left: 65.78125px;
                  top: 202.16015625px;
                  text-align: left;
                  margin-top: 50px;
                  margin-left: 100px;
                  font-family: Poppins;
                  font-size: 16px;
                  font-weight: 500;
                  line-height: 22px;
                  letter-spacing: 0em;
                  text-align: left;">
                    Changing the Report Template or Reporting Units create new changes to this document. Are you sure you want to proceed?
                  </div>
                  <div class="btm-btn">
                    <button type='button' class="warning-btn" onclick="closeTemplateModal()">
                      Cancel
                    </button>
                    <div style="width: 11.78px;"></div>
                    <button type='button' class="warning-btn" onclick="proceedChanges()">
                      Proceed
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div style="margin-left: 20.51px; margin-top: 3px;">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            fill="currentColor"
            class="bi bi-chevron-down"
            viewBox="0 0 16 16"
          >
            <path
              fill-rule="evenodd"
              d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"
            />
          </svg>
        </div>
      </div>
    </div>
  </div>
  <div class="report-view">
    <div id="err-blk">
      <div
        style="
          height: 20.21514892578125px;
          width: 271.31256103515625px;
          left: 1055.45703125px;
          top: 601.640625px;
          font-family: Poppins;
          font-size: 10px;
          font-weight: 400;
          line-height: 12px;
          letter-spacing: 0em;
          text-align: right;
          color: #d63636;
          margin-left: -14px;
        "
      >
        Invalid input(s) found.
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="11"
          height="11"
          fill="red"
          class="bi bi-exclamation-circle"
          viewBox="0 0 16 16"
          style="margin: 0 0 3px 3px;"
        >
          <path
            d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"
          />
          <path
            d="M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z"
          />
        </svg>
      </div>
      <div class="err-msg">
        This draft report is generated with invalid input(s). Please refer to
        the CSV and correct data in the system
      </div>
    </div>
    <div
      class="modal"
      id="warningModal"
      tabindex="-1"
      aria-labelledby="warningModalLabel"
      aria-hidden="true"
      >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header"
          style="
          height: 117.37568664550781px;
          width: 681.9871826171875px;
          background-color: #de7777;">
            <svg xmlns="http://www.w3.org/2000/svg" width="46.41" height="40" fill="white" class="bi bi-exclamation-triangle-fill" viewBox="0 0 16 16"
            style="margin: 38.01px 74.66px 35.37px 69.41px;">
              <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
            </svg>
            <h5 class="modal-title" id="warning-modal-title">Error Warning</h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
              onclick="closeWarningModal()"
              aria-label="Close"
              style="margin-right: 10px; margin-top:-35px; height:13.12px; color: white; opacity: 1;"
            ></button>
          </div>
          <div class="modal-body" style="height: 284.62px; width: 682px;border-radius: 0 0 15px 15px; background-color: #ffffff;">
            <div class="modal-text" style="
            color: #de7777;
            height: 143.82505798339844px;
            width: 470.2766723632812px;
            left: 65.78125px;
            top: 202.16015625px;
            text-align: left;
            margin-top: 50px;
            margin-left: 100px;
            font-family: Poppins;
            font-size: 16px;
            font-weight: 500;
            line-height: 22px;
            letter-spacing: 0em;
            text-align: left;">
              There are some fields with invalid and/or missing data. Please
              check the CSV and make changes to the respective fields in the
              system.
            </div>
            <div class="btm-btn">
              <button type='button' class="warning-btn" onclick="downloadCSVAbort()">
                Download CSV and Abort
              </button>
              <div style="width: 11.78px;"></div>
              <button type='button' class="warning-btn" onclick="downloadCSVProceed()">
                Download CSV and Proceed
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="audit-log-link">
      <a
        data-bs-target="#auditLog"
        data-bs-toggle="modal"
        style="
          font-family: Poppins;
          font-size: 10px;
          font-weight: 600;
          line-height: 12px;
          letter-spacing: 0em;
          text-align: left;
          color: #7788a3;
          text-decoration: underline;
        "
      >
        Last PDF generated: {{latest_generated_by}} {{latest_generated_timestamp}}
      </a>
      <div
        class="modal fade"
        id="auditLog"
        tabindex="-1"
        aria-labelledby="auditLogLabel"
        aria-hidden="true"
        style="
        margin-top: 300px;
        height: 500.32px;
        width: 681.99px;
        margin-left:300px;"
      >
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header border-0" id="audit-modal-header">
              <div style="display: flex; flex-direction: row;">
                <p class="modal-title" id="auditLogLabel">
                  Report PDF
                </p>
                <button
                  type="button"
                  class="btn-close btn-close-white"
                  data-bs-dismiss="modal"
                  aria-label="Close"
                  style="
                    margin-right: 10px;
                    margin-top: 12px;
                    height: 13.12px;
                    opacity: 0.3;
                    font-weight: 3.02px solid;
                  "
                ></button>
              </div>
              <div style="text-align: left; float: left;">
                <p
                  style="
                    font-family: Poppins;
                    font-size: 12px;
                    font-weight: 700;
                    line-height: 14px;
                    letter-spacing: 0em;
                    text-align: left;
                    color: #717171;
                    height: 32.094635009765625px;
                    width: 289.3226623535156px;
                    top: 69.244140625px;
                    border-radius: nullpx;
                    margin-left: -145px;
                    margin-top: 5px;
                    padding: 0px;
                  "
                >
                  Audit Trail
                </p>
              </div>
              <hr style="
              background: linear-gradient(0deg, rgba(97, 97, 97, 0.3), rgba(97, 97, 97, 0.3)), linear-gradient(0deg, rgba(196, 196, 196, 0), rgba(196, 196, 196, 0));
              border: 1px solid #6161614D;
              width: 460.62109375px;
              left: 35.84765625px;
              top: 109.96875px;
              border-radius: 0px;
              margin-top: -15px;
              "></hr>
            </div>
            <div class="modal-body" id="audit-modal-body">
              <div class="log-rec">
                <div class="log-col-header">
                  Date & Time:
                </div>
                <div class="log-col-header">
                  Action:
                </div>
                <div class="log-col-header">
                  User:
                </div>
              </div>
              <div>
                <div style="height: 10px;"></div>
                {% for info in log_info %}
                  <div class="log-rec">
                    <div class="log-col">
                        {{info.0}}
                    </div>
                    <div class="log-col">
                        {{info.1}}
                    </div>
                    <div class="log-col">
                        {{info.2}}
                    </div>
                  </div>
                {% endfor %}
              </div>
            </div>
            <div class="modal-btm">
                <button class="close-btn" data-bs-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <object class="pdfViewerObj" id='pdfViewerObj' type="application/pdf">
    </object>
  </div>
</div>
{% endblock %}
